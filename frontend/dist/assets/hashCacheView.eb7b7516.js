import{n as l}from"./index.753eb690.js";import"./vendor.6aa46313.js";var d=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"cont"},[t("v-row",{staticClass:"align-center"},[t("v-col",[t("v-card-title",{staticClass:"py-2"},[t("v-text-field",{attrs:{clearable:"",flat:"",outlined:"","prepend-inner-icon":"mdi-database-search",label:"Search by password or hash","single-line":"","hide-details":""},model:{value:e.search,callback:function(a){e.search=a},expression:"search"}})],1)],1),t("v-col",[e.selectedHashes.length>0?t("v-btn",{staticClass:"mr-2",attrs:{text:""},on:{click:e.multiDelete}},[t("v-icon",{attrs:{left:""}},[e._v(" mdi-delete ")]),e._v(" Delete ")],1):e._e(),t("v-btn",{staticClass:"mr-2",attrs:{text:""},on:{click:e.exportAllCrackedHashes}},[t("v-icon",{attrs:{left:""}},[e._v(" mdi-export ")]),e._v(" Export all cracked hashes ")],1)],1)],1),t("v-divider"),t("v-data-table",{ref:"table",attrs:{headers:e.headers,items:e.hashes,search:e.search,options:e.pagination,"server-items-length":e.totalItems,loading:e.loading,"footer-props":{itemsPerPageOptions:[25,50,100],itemsPerPageText:"Passwords per page"},"show-select":"","fixed-header":""},on:{"update:options":function(a){e.pagination=a}},scopedSlots:e._u([{key:"item.password",fn:function(a){var s=a.item;return[e._v(" "+e._s(s.password||"\u2013")+" ")]}},{key:"item.hash",fn:function(a){var s=a.item;return[t("div",{staticClass:"d-flex align-center mw-50"},[t("v-dialog",{attrs:{"max-width":"600"},scopedSlots:e._u([{key:"activator",fn:function(n){var o=n.on;return[t("span",e._g({staticClass:"text-truncate d-inline-block"},o),[e._v(" "+e._s(s.hash)+" ")])]}}],null,!0)},[t("v-card",[t("v-card-title",{attrs:{"primary-title":""}},[e._v(" "+e._s(s.hash_type_name)+" ")]),t("v-card-text",[e._v(" "+e._s(s.hash)+" ")])],1)],1)],1)]}},{key:"item.added",fn:function(a){var s=a.item;return[e._v(" "+e._s(e.$moment.utc(s.added).local().format("D.M.YYYY H:mm:ss"))+" ")]}},{key:"item.job",fn:function(a){var s=a.item;return[t("router-link",{staticClass:"middle",attrs:{to:{name:"jobDetail",params:{id:s.job.id}}}},[e._v(" "+e._s(s.job.name)+" ")])]}}]),model:{value:e.selectedHashes,callback:function(a){e.selectedHashes=a},expression:"selectedHashes"}})],1)},h=[];const c={name:"HashesView",data:function(){return{interval:null,status:"active",search:"",totalItems:0,pagination:{},loading:!0,selectedHashes:[],headers:[{text:"Password",value:"password",align:"start",sortable:!0},{text:"Hash type",value:"hash_type_name",align:"start",sortable:!0},{text:"Hash",value:"hash",align:"start",sortable:!0},{text:"Added",value:"added",align:"start",sortable:!0},{text:"Job",value:"job",align:"end",sortable:!0}],hashes:[]}},watch:{pagination:{handler(){this.loading=!0,this.loadHashes()},deep:!0}},mounted(){this.interval=setInterval(function(){this.loadHashes()}.bind(this),5e3)},beforeDestroy:function(){clearInterval(this.interval)},methods:{loadHashes(){this.axios.get(this.$serverAddr+"/hashes",{params:{page:this.pagination.page,per_page:this.pagination.rowsPerPage,order_by:this.pagination.sortBy[0],descending:this.pagination.sortDesc[0],search:this.search}}).then(e=>{this.hashes=e.data.items,this.totalItems=e.data.total,this.loading=!1})},updateStatus:function(e){this.status=e,this.$refs.table.updatePagination({page:1,totalItems:this.totalItems})},exportAllCrackedHashes(){this.axios.get(this.$serverAddr+"/hashes/exportCrackedHashes").then(e=>{const r=window.URL.createObjectURL(new Blob([e.data])),t=document.createElement("a");t.href=r,t.setAttribute("download","cracked_hashes.csv"),document.body.appendChild(t),t.click()}).catch(e=>{console.error("Error downloading file:",e)})},multiDelete(){this.selectedHashes.length!=0&&(this.loading=!0,this.axios.patch(this.$serverAddr+"/hashes",{hash_ids:this.selectedHashes.map(e=>e.id)}).then(e=>{this.loadHashes()}))}}},i={};var u=l(c,d,h,!1,v,"548e22b8",null,null);function v(e){for(let r in i)this[r]=i[r]}var _=function(){return u.exports}();export{_ as default};
