var ae=Object.defineProperty,ie=Object.defineProperties;var re=Object.getOwnPropertyDescriptors;var F=Object.getOwnPropertySymbols;var ne=Object.prototype.hasOwnProperty,le=Object.prototype.propertyIsEnumerable;var T=(e,a,t)=>a in e?ae(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,v=(e,a)=>{for(var t in a||(a={}))ne.call(a,t)&&T(e,t,a[t]);if(F)for(var t of F(a))le.call(a,t)&&T(e,t,a[t]);return e},g=(e,a)=>ie(e,re(a));import{f as x}from"./numberFormat.773889d3.js";import{a as oe}from"./iconMaps.0c6dd037.js";import{d as b}from"./dictionarySelector.c62ca522.js";import{m as h}from"./spyfu-vuex-helpers.esm.87da45d6.js";import{t as p,n as l,a as ce}from"./index.ee5933a8.js";import{s as y}from"./selectorMixin.a647ee87.js";import{j as D,o as H,i as de}from"./vendor.6aa46313.js";import{F as ue}from"./fileUploader.356a4735.js";import{f as me}from"./fc_textarea.0639e230.js";import{h as ve}from"./hostSelector.f31d571f.js";import{D as he}from"./datetime.7e92406c.js";import"./vue-infinite-loading.33b09e95.js";import"./index.09a07ba8.js";import"./index.a9d6c6c2.js";var A={exports:{}},L={exports:{}};(function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a={rotl:function(t,s){return t<<s|t>>>32-s},rotr:function(t,s){return t<<32-s|t>>>s},endian:function(t){if(t.constructor==Number)return a.rotl(t,8)&16711935|a.rotl(t,24)&4278255360;for(var s=0;s<t.length;s++)t[s]=a.endian(t[s]);return t},randomBytes:function(t){for(var s=[];t>0;t--)s.push(Math.floor(Math.random()*256));return s},bytesToWords:function(t){for(var s=[],i=0,r=0;i<t.length;i++,r+=8)s[r>>>5]|=t[i]<<24-r%32;return s},wordsToBytes:function(t){for(var s=[],i=0;i<t.length*32;i+=8)s.push(t[i>>>5]>>>24-i%32&255);return s},bytesToHex:function(t){for(var s=[],i=0;i<t.length;i++)s.push((t[i]>>>4).toString(16)),s.push((t[i]&15).toString(16));return s.join("")},hexToBytes:function(t){for(var s=[],i=0;i<t.length;i+=2)s.push(parseInt(t.substr(i,2),16));return s},bytesToBase64:function(t){for(var s=[],i=0;i<t.length;i+=3)for(var r=t[i]<<16|t[i+1]<<8|t[i+2],n=0;n<4;n++)i*8+n*6<=t.length*8?s.push(e.charAt(r>>>6*(3-n)&63)):s.push("=");return s.join("")},base64ToBytes:function(t){t=t.replace(/[^A-Z0-9+\/]/ig,"");for(var s=[],i=0,r=0;i<t.length;r=++i%4)r!=0&&s.push((e.indexOf(t.charAt(i-1))&Math.pow(2,-2*r+8)-1)<<r*2|e.indexOf(t.charAt(i))>>>6-r*2);return s}};L.exports=a})();var w={utf8:{stringToBytes:function(e){return w.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(w.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var a=[],t=0;t<e.length;t++)a.push(e.charCodeAt(t)&255);return a},bytesToString:function(e){for(var a=[],t=0;t<e.length;t++)a.push(String.fromCharCode(e[t]));return a.join("")}}},j=w;(function(){var e=L.exports,a=j.utf8,t=j.bin,s=function(r){r.constructor==String?r=a.stringToBytes(r):typeof Buffer!="undefined"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(r)?r=Array.prototype.slice.call(r,0):Array.isArray(r)||(r=r.toString());var n=e.bytesToWords(r),d=r.length*8,f=[],_=1732584193,c=-271733879,u=-1732584194,m=271733878,k=-1009589776;n[d>>5]|=128<<24-d%32,n[(d+64>>>9<<4)+15]=d;for(var $=0;$<n.length;$+=16){for(var G=_,Q=c,X=u,ee=m,te=k,o=0;o<80;o++){if(o<16)f[o]=n[$+o];else{var C=f[o-3]^f[o-8]^f[o-14]^f[o-16];f[o]=C<<1|C>>>31}var se=(_<<5|_>>>27)+k+(f[o]>>>0)+(o<20?(c&u|~c&m)+1518500249:o<40?(c^u^m)+1859775393:o<60?(c&u|c&m|u&m)-1894007588:(c^u^m)-899497514);k=m,m=u,u=c<<30|c>>>2,c=_,_=se}_+=G,c+=Q,u+=X,m+=ee,k+=te}return[_,c,u,m,k]},i=function(r,n){var d=e.wordsToBytes(s(r));return n&&n.asBytes?d:n&&n.asString?t.bytesToString(d):e.bytesToHex(d)};i._blocksize=16,i._digestsize=20,A.exports=i})();var pe=A.exports,fe=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("v-row",[t("v-col",{staticClass:"border",attrs:{cols:"6"}},[t("v-card-title",[t("span",[e._v("Select left dictionary"),t("span",{staticClass:"required primary--text"},[e._v(" *")])])])],1),t("v-col",{attrs:{cols:"6"}},[t("v-card-title",[t("span",[e._v("Select right dictionary"),t("span",{staticClass:"required primary--text"},[e._v(" *")])])])],1),t("v-col",{staticClass:"border",attrs:{cols:"6"}},[t("dict-selector",{attrs:{"select-all":""},on:{input:e.checkValid},model:{value:e.leftDicts,callback:function(s){e.leftDicts=s},expression:"leftDicts"}})],1),t("v-col",{attrs:{cols:"6"}},[t("dict-selector",{attrs:{"select-all":""},on:{input:e.checkValid},model:{value:e.rightDicts,callback:function(s){e.rightDicts=s},expression:"rightDicts"}})],1),t("v-col",{staticClass:"border",attrs:{cols:"6"}},[t("v-card-title",[t("span",[e._v("Type left rule")])])],1),t("v-col",{attrs:{cols:"6"}},[t("v-card-title",[t("span",[e._v("Type right rule")])])],1),t("v-col",{staticClass:"border px-2",attrs:{cols:"6"}},[t("v-text-field",{attrs:{outlined:"","single-line":"",placeholder:"Rule"},on:{input:e.checkValid},model:{value:e.ruleLeft,callback:function(s){e.ruleLeft=s},expression:"ruleLeft"}})],1),t("v-col",{staticClass:"px-2",attrs:{cols:"6"}},[t("v-text-field",{attrs:{outlined:"","single-line":"",placeholder:"Rule"},on:{input:e.checkValid},model:{value:e.ruleRight,callback:function(s){e.ruleRight=s},expression:"ruleRight"}})],1)],1),t("v-divider"),e.$optimizedOnly?e._e():t("v-checkbox",{attrs:{label:"Use optimized computing kernels (limits password length, disable for passwords over 256 chars long)"},model:{value:e.optimized,callback:function(s){e.optimized=s},expression:"optimized"}})],1)},_e=[];const ke={name:"Combinator",components:{"dict-selector":b},computed:h("jobForm",p(["leftDicts","ruleLeft","rightDicts","ruleRight","optimized"])),methods:{checkValid:function(){return this.leftDicts.length>0&&this.rightDicts.length>0}}},N={};var ge=l(ke,fe,_e,!1,be,"232785d5",null,null);function be(e){for(let a in N)this[a]=N[a]}var ye=function(){return ge.exports}(),xe=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"mask-container"},[t("transition",{attrs:{name:"toolbar-fade"}},[t("v-sheet",{directives:[{name:"show",rawName:"v-show",value:e.focused,expression:"focused"}],staticClass:"charset-toolbar pa-1",attrs:{id:e.id?e.id+"-chips-editor":void 0,elevation:8}},[e._l(e.represenArray,function(s,i){return t("v-chip",{key:i,staticClass:"ma-1",attrs:{color:"primary"},on:{click:function(r){return e.addSymbol(i)}}},[e._v(" "+e._s(s.represent)+" ")])}),e._l(e.customCharsets,function(s,i){return t("v-chip",{key:i,staticClass:"ma-1",attrs:{color:"info"},on:{click:function(r){return e.addSymbol(i+1)}}},[e._v(" "+e._s(s.name)+" ")])})],2)],1),t("div",{staticClass:"mask-input"},[t("v-text-field",{ref:"field",attrs:{id:e.id?e.id+"-mask-input":void 0,label:"Enter mask",filled:"",outlined:"",dense:"","single-line":"",rules:e.maskRules,value:e.value},on:{input:function(s){return e.rawValue=s},focus:function(s){e.focused=!0},blur:function(s){e.focused=!1}}}),t("v-btn",{directives:[{name:"show",rawName:"v-show",value:!e.nonRemovable,expression:"!nonRemovable"}],staticClass:"ml-2 remove-button",attrs:{id:e.id?e.id+"-mask-remove":void 0,icon:""},on:{click:function(s){return e.$emit("remove")}}},[t("v-icon",[e._v("mdi-delete")])],1)],1)],1)},$e=[];const we={name:"MaskSingle",props:{id:{type:String,default:""},value:{type:String,default:""},nonRemovable:{type:Boolean,default:!1},customCharsets:{type:[Array,null],default:null}},data(){return{rawValue:"",focused:!1,maskRules:[e=>{let a=!1;for(let t of e){if(a){if(t==="?"){a=!1;continue}if(this.represenArray[t]===void 0&&(this.customCharsets==null||!this.customCharsets[parseInt(t)-1]))return`Unknown symbol ?${t}`;a=!1;continue}t==="?"?a=!0:a=!1}return!0},e=>/^(\?[ludhHsab1234?]|[^\?])+$/.test(e)||"Invalid mask"],represenArray:{l:{chars:"abcdefghijklmnopqrstuvwxyz",represent:"a-z"},u:{chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",represent:"A-Z"},d:{chars:"0123456789",represent:"0-9"},h:{chars:"0123456789abcdef",represent:"0-f"},H:{chars:"0123456789ABCDEF",represent:"0-F"},s:{chars:'\xABspace\xBB!"#$%&()*+,-./:;<=>?@[]^_`{|}~',represent:"special"},a:{chars:"?l?u?d?s",represent:"a-z,A-Z,0-9,special"},b:{chars:"0x00 - 0xff",represent:"ASCII"},"?":{chars:"?",represent:"?"}}}},computed:{},watch:{rawValue(e){this.$emit("input",e)}},methods:{addSymbol:function(e){this.rawValue+="?"+e,this.$refs.field.$el.value=this.rawValue,this.$refs.field.focus()}}},R={};var Se=l(we,xe,$e,!1,Me,"6883428c",null,null);function Me(e){for(let a in R)this[a]=R[a]}var S=function(){return Se.exports}(),Ce=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("v-data-table",{attrs:{value:e.selected,headers:e.headers,items:e.items,"items-per-page":e.itemsPerPage,"footer-props":e.footerProps,search:e.search,"item-key":"id","show-select":"","single-select":!e.selectAll},on:{input:e.updateSelected},scopedSlots:e._u([{key:"item.name",fn:function(s){var i=s.item;return[t("router-link",{attrs:{to:{name:"charsetDetail",params:{id:i.id}}}},[e._v(" "+e._s(i.name)+" "),t("v-icon",{attrs:{small:"",color:"primary"}},[e._v(" mdi-open-in-new ")])],1)]}},{key:"item.keyspace",fn:function(s){var i=s.item;return[e._v(" "+e._s(e.fmt(i.keyspace))+" ")]}},{key:"item.time",fn:function(s){var i=s.item;return[e._v(" "+e._s(e.$moment.utc(i.time).local().format("DD.MM.YYYY HH:mm"))+" ")]}}])})},Fe=[];const Te={name:"CharsetSelector",mixins:[y],data(){return{headers:[{text:"Name",align:"start",value:"name"},{text:"Keyspace",value:"keyspace",align:"end"}]}},methods:{fmt:x,getData(){this.loading=!0,this.axios.get(this.$serverAddr+"/charset").then(e=>{this.items=e.data.items,this.loading=!1})},updateSelected(e){e.length>4&&(e=e.slice(1).slice(-4)),this.selected=e,this.$emit("input",e)}}},E={};var De=l(Te,Ce,Fe,!1,He,"28cd8ebc",null,null);function He(e){for(let a in E)this[a]=E[a]}var P=function(){return De.exports}(),Ae=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("v-data-table",{attrs:{headers:e.headers,items:e.items,"items-per-page":e.itemsPerPage,"footer-props":e.footerProps,search:e.search,"item-key":"id","show-select":"","single-select":!e.selectAll},on:{input:e.updateSelected},scopedSlots:e._u([{key:"item.data-table-select",fn:function(s){var i=s.select,r=s.isSelected;return[t("v-simple-checkbox",{attrs:{value:r,disabled:e.markovSubmode==0},on:{input:i}})]}},{key:"item.time",fn:function(s){var i=s.item;return[e._v(" "+e._s(e.$moment.utc(i.time).local().format("DD.MM.YYYY HH:mm"))+" ")]}}]),model:{value:e.selected,callback:function(s){e.selected=s},expression:"selected"}})},Le=[];const je={name:"MarkovSelector",mixins:[y],props:{value:{type:Array,default:()=>[]},markovSubmode:{type:Number,default:2}},data(){return{headers:[{text:"Name",align:"start",value:"name"},{text:"Added",value:"time",align:"end"}]}},methods:{getData(){this.loading=!0,this.axios.get(this.$serverAddr+"/markovChains").then(e=>{this.items=e.data.items,this.selected=[this.items.find(a=>a.name==="hashcat.hcstat2")],this.loading=!1})}}},z={};var Ne=l(je,Ae,Le,!1,Re,null,null,null);function Re(e){for(let a in z)this[a]=z[a]}var Ee=function(){return Ne.exports}(),Pe=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("v-data-table",{attrs:{headers:e.headers,items:e.items,"items-per-page":e.itemsPerPage,"footer-props":e.footerProps,search:e.search,"item-key":"id","show-select":"","single-select":!e.selectAll},on:{input:e.updateSelected},scopedSlots:e._u([{key:"item.name",fn:function(s){var i=s.item;return[t("router-link",{attrs:{to:{name:"maskDetail",params:{id:i.id}}}},[e._v(" "+e._s(i.name)+" "),t("v-icon",{attrs:{small:"",color:"primary"}},[e._v(" mdi-open-in-new ")])],1)]}},{key:"item.time",fn:function(s){var i=s.item;return[e._v(" "+e._s(e.$moment.utc(i.time).local().format("DD.MM.YYYY HH:mm"))+" ")]}}]),model:{value:e.selected,callback:function(s){e.selected=s},expression:"selected"}})},ze=[];const Ie={name:"MaskFileSelector",mixins:[y],props:{value:{type:Object,default:function(){return{}}}},data(){return{headers:[{text:"Name",align:"start",value:"name"},{text:"Added",value:"time",align:"end"}]}},computed:{selectedId(){return selected[0].id}},watch:{value(e){this.selected=[e]}},methods:{getData(){this.loading=!0,this.axios.get(this.$serverAddr+"/masks").then(e=>{this.items=e.data.items,this.loading=!1})},updateSelected(){this.$emit("input",this.selected[0])}}},I={};var Ve=l(Ie,Pe,ze,!1,Ye,"f581acce",null,null);function Ye(e){for(let a in I)this[a]=I[a]}var Be=function(){return Ve.exports}(),qe=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("v-card-title",{staticClass:"pb-0 mb-2"},[t("span",[e._v("Add masks"),t("span",{staticClass:"required primary--text"},[e._v(" *")])])]),t("v-row",{staticClass:"mb-4 px-4"},[t("v-btn",{attrs:{color:"primary",text:""},on:{click:function(s){e.loadMasksDialog=!0}}},[t("v-icon",{attrs:{left:""}},[e._v(" mdi-file-download ")]),e._v(" Load masks ")],1),t("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.masks.length>1,expression:"masks.length > 1"}],attrs:{color:"error",text:""},on:{click:function(s){e.masks=[""]}}},[t("v-icon",{attrs:{left:""}},[e._v(" mdi-restart ")]),e._v(" Reset masks ")],1),t("v-spacer"),t("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.masks.length<50,expression:"masks.length < 50"}],attrs:{id:"add-mask-button",color:"success"},on:{click:function(s){return e.addMask()}}},[t("v-icon",{attrs:{left:""}},[e._v(" mdi-plus ")]),e._v(" Add mask ")],1)],1),e.masks.length<50?t("div",{staticClass:"mask-editors"},e._l(e.masks,function(s,i){return t("mask-single",{key:i,attrs:{id:"mask-"+i,"non-removable":e.masks.length==1,"custom-charsets":e.charset,value:s},on:{input:function(r){return e.updateMask({index:i,val:r})},remove:function(r){return e.deleteMask(i)}}})}),1):t("v-alert",{attrs:{type:"info"}},[e._v(" Not showing "+e._s(e.masks.length)+" masks to maintain performance and conciseness. ")]),t("v-row",[t("v-col",{staticClass:"border",attrs:{cols:"6"}},[t("v-card-title",[t("span",[e._v("Select charsets (max. 4)")])]),t("charset-selector",{attrs:{"select-all":""},model:{value:e.charset,callback:function(s){e.charset=s},expression:"charset"}})],1),t("v-col",{attrs:{cols:"6"}},[t("v-card-title",[t("span",[e._v("Markov file")])]),t("markov-selector",{attrs:{"markov-submode":e.submode},on:{input:e.checkValid},model:{value:e.markov,callback:function(s){e.markov=s},expression:"markov"}}),t("v-row",[t("v-col",{staticClass:"pl-2",attrs:{cols:"6"}},[t("v-radio-group",{attrs:{column:""},on:{change:e.checkValid},model:{value:e.submode,callback:function(s){e.submode=s},expression:"submode"}},[t("v-radio",{attrs:{label:"Markov disabled",color:"primary",value:0}}),t("v-radio",{attrs:{label:"2D Markov",color:"primary",value:1}}),t("v-radio",{attrs:{label:"3D Markov",color:"primary",value:2}})],1)],1),t("v-col",{staticClass:"pr-2",attrs:{cols:"6"}},[t("v-text-field",{attrs:{type:"number",disabled:e.submode===0,label:"Markov threshold",filled:"",dense:"",mask:"########"},on:{input:e.checkValid},model:{value:e.markovThresh,callback:function(s){e.markovThresh=s},expression:"markovThresh"}})],1)],1)],1)],1),t("v-dialog",{attrs:{"max-width":"600"},model:{value:e.loadMasksDialog,callback:function(s){e.loadMasksDialog=s},expression:"loadMasksDialog"}},[t("v-card",[t("v-card-text",[t("maskFile-selector",{on:{input:e.checkValid},model:{value:e.maskFile,callback:function(s){e.maskFile=s},expression:"maskFile"}})],1),t("v-card-actions",[t("v-btn",{attrs:{color:"primary",disabled:!e.maskFile},on:{click:e.loadMasksFromFile}},[e._v(" Load ")])],1)],1)],1),t("v-divider"),e.$optimizedOnly?e._e():t("v-checkbox",{attrs:{label:"Use optimized computing kernels (limits password length, disable for passwords over 256 chars long)"},model:{value:e.optimized,callback:function(s){e.optimized=s},expression:"optimized"}})],1)},Je=[];const Ue={name:"FcMask",components:{CharsetSelector:P,"mask-single":S,"charset-selector":P,"markov-selector":Ee,"maskFile-selector":Be},data:function(){return{loadMasksDialog:!1,maskFile:null}},computed:v({},h("jobForm",p(["masks","submode","markovThresh","markov","charset","optimized"]))),methods:g(v({},D("jobForm",["addMask","deleteMask","updateMask","mergeMasks"])),{loadMasksFromFile:function(){this.axios.get(this.$serverAddr+"/masks/"+this.maskFile.id).then(e=>{var a=e.data.data.split(`
`);this.mergeMasks(a),this.maskFile=null,this.loadMasksDialog=!1,this.checkValid()})},checkValid:function(){return this.masks[0]!==""}})},V={};var Oe=l(Ue,qe,Je,!1,We,"3460c326",null,null);function We(e){for(let a in V)this[a]=V[a]}var Ke=function(){return Oe.exports}(),Ze=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("v-data-table",{attrs:{headers:e.headers,items:e.items,"items-per-page":e.itemsPerPage,"footer-props":e.footerProps,search:e.search,"item-key":"id","show-select":"","single-select":!e.selectAll},on:{input:e.updateSelected},scopedSlots:e._u([{key:"item.name",fn:function(s){var i=s.item;return[t("router-link",{attrs:{to:{name:"ruleDetail",params:{id:i.id}}}},[e._v(" "+e._s(i.name)+" "),t("v-icon",{attrs:{small:"",color:"primary"}},[e._v(" mdi-open-in-new ")])],1)]}},{key:"item.count",fn:function(s){var i=s.item;return[e._v(" "+e._s(e.fmt(i.count))+" ")]}},{key:"item.time",fn:function(s){var i=s.item;return[e._v(" "+e._s(e.$moment.utc(i.time).local().format("DD.MM.YYYY HH:mm"))+" ")]}}]),model:{value:e.selected,callback:function(s){e.selected=s},expression:"selected"}})},Ge=[];const Qe={name:"RulesSelector",mixins:[y],data(){return{headers:[{text:"Name",align:"start",value:"name"},{text:"Count",value:"count",align:"end"},{text:"Added",value:"time",align:"end"}]}},methods:{fmt:x,getData(){this.loading=!0,this.axios.get(this.$serverAddr+"/rule").then(e=>{this.items=e.data.items,this.loading=!1})}}},Y={};var Xe=l(Qe,Ze,Ge,!1,et,null,null,null);function et(e){for(let a in Y)this[a]=Y[a]}var M=function(){return Xe.exports}(),tt=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("v-card-title",[t("span",[e._v("Select dictionary"),t("span",{staticClass:"required primary--text"},[e._v(" *")])])]),t("dict-selector",{attrs:{"select-all":""},on:{input:e.checkValid},model:{value:e.leftDicts,callback:function(s){e.leftDicts=s},expression:"leftDicts"}}),t("v-divider"),t("v-card-title",[t("span",[e._v("Fragmentation of dictionaries")])]),t("v-radio-group",{model:{value:e.distributionMode,callback:function(s){e.distributionMode=s},expression:"distributionMode"}},[t("v-radio",{attrs:{label:"On server",value:0}}),t("v-radio",{attrs:{label:"On hosts",value:1}})],1),t("v-divider"),e.distributionMode==1?t("div",[t("v-card-title",[t("span",[e._v("Deployment of dictionaries")])]),t("v-radio-group",{model:{value:e.dictDeploymentMode,callback:function(s){e.dictDeploymentMode=s},expression:"dictDeploymentMode"}},[t("v-radio",{attrs:{label:"Automatically send dictionaries to hosts",value:0}}),e.leftDicts.length==1?t("v-radio",{attrs:{label:"Use prestored dictionaries on hosts",value:1}}):e._e()],1),t("v-divider")],1):e._e(),t("v-card-title",[t("span",[e._v("Select rule file")])]),t("rules-selector",{on:{input:e.checkValid},model:{value:e.rules,callback:function(s){e.rules=s},expression:"rules"}}),t("v-divider"),e.$optimizedOnly?e._e():t("v-checkbox",{attrs:{label:"Use optimized computing kernels (limits password length, disable for passwords over 256 chars long)"},model:{value:e.optimized,callback:function(s){e.optimized=s},expression:"optimized"}})],1)},st=[];const at={name:"Dictionary",components:{"dict-selector":b,"rules-selector":M},computed:h("jobForm",p(["leftDicts","rules","optimized","distributionMode","dictDeploymentMode"])),methods:{checkValid:function(){return this.leftDicts.length>0}}},B={};var it=l(at,tt,st,!1,rt,"105306ec",null,null);function rt(e){for(let a in B)this[a]=B[a]}var nt=function(){return it.exports}(),lt=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("v-row",[t("v-col",{staticClass:"border",attrs:{cols:"6"}},[t("v-card-title",[t("span",[e._v("Type mask"),t("span",{staticClass:"required primary--text"},[e._v(" *")])])])],1),t("v-col",{attrs:{cols:"6"}},[t("v-card-title",[t("span",[e._v("Select dictionary"),t("span",{staticClass:"required primary--text"},[e._v(" *")])])])],1),t("v-col",{staticClass:"border",attrs:{cols:"6"}},[t("mask-single",{attrs:{"non-removable":""},on:{input:e.checkValid},model:{value:e.hybridMask,callback:function(s){e.hybridMask=s},expression:"hybridMask"}})],1),t("v-col",{attrs:{cols:"6"}},[t("dict-selector",{attrs:{"select-all":""},on:{input:e.checkValid},model:{value:e.rightDicts,callback:function(s){e.rightDicts=s},expression:"rightDicts"}}),t("v-card-title",[t("span",[e._v("Type rule")])]),t("v-text-field",{attrs:{outlined:"","single-line":"",placeholder:"Rule"},on:{input:e.checkValid},model:{value:e.ruleRight,callback:function(s){e.ruleRight=s},expression:"ruleRight"}})],1)],1),t("v-divider"),e.$optimizedOnly?e._e():t("v-checkbox",{attrs:{label:"Use optimized computing kernels (limits password length, disable for passwords over 256 chars long)"},model:{value:e.optimized,callback:function(s){e.optimized=s},expression:"optimized"}})],1)},ot=[];const ct={name:"HybridWordlistMask",components:{"mask-single":S,"dict-selector":b},data:function(){return{attackId:7,attackName:"Hybrid mask+wordlist",maskRules:[e=>/^(\?[ludhHsab]|[ -~])+$/.test(e)||"Not valid mask"]}},computed:h("jobForm",p(["ruleLeft","rightDicts","ruleRight","hybridMask","optimized"])),methods:{dictSelected:function(e,a){this.selectedDict2Id=e,this.checkValid()},checkValid:function(){return this.hybridMask!==""&&this.rightDicts.length>0}}},q={};var dt=l(ct,lt,ot,!1,ut,"d20041c8",null,null);function ut(e){for(let a in q)this[a]=q[a]}var mt=function(){return dt.exports}(),vt=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("v-row",[t("v-col",{staticClass:"border",attrs:{cols:"6"}},[t("v-card-title",[t("span",[e._v("Select dictionary"),t("span",{staticClass:"required primary--text"},[e._v(" *")])])])],1),t("v-col",{attrs:{cols:"6"}},[t("v-card-title",[t("span",[e._v("Type mask"),t("span",{staticClass:"required primary--text"},[e._v(" *")])])])],1),t("v-col",{staticClass:"border",attrs:{cols:"6"}},[t("dict-selector",{attrs:{"select-all":""},on:{input:e.checkValid},model:{value:e.leftDicts,callback:function(s){e.leftDicts=s},expression:"leftDicts"}}),t("v-card-title",[t("span",[e._v("Type rule")])]),t("v-text-field",{attrs:{outlined:"","single-line":"",placeholder:"Rule"},on:{input:e.checkValid},model:{value:e.ruleLeft,callback:function(s){e.ruleLeft=s},expression:"ruleLeft"}})],1),t("v-col",{attrs:{cols:"6"}},[t("mask-single",{attrs:{"non-removable":""},on:{input:e.checkValid},model:{value:e.hybridMask,callback:function(s){e.hybridMask=s},expression:"hybridMask"}})],1)],1),t("v-divider"),e.$optimizedOnly?e._e():t("v-checkbox",{attrs:{label:"Use optimized computing kernels (limits password length, disable for passwords over 256 chars long)"},model:{value:e.optimized,callback:function(s){e.optimized=s},expression:"optimized"}})],1)},ht=[];const pt={name:"HybridMaskWordlist",components:{"mask-single":S,"dict-selector":b},data:function(){return{attackId:6,attackName:"Hybrid wordlist+mask",maskRules:[e=>/^(\?[ludhHsab]|[ -~])+$/.test(e)||"Not valid mask"]}},computed:h("jobForm",p(["ruleLeft","leftDicts","ruleRight","hybridMask","optimized"])),methods:{checkValid:function(){return this.hybridMask!==""&&this.leftDicts.length>0}}},J={};var ft=l(pt,vt,ht,!1,_t,"7c98baa2",null,null);function _t(e){for(let a in J)this[a]=J[a]}var kt=function(){return ft.exports}(),gt=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("v-data-table",{attrs:{headers:e.headers,items:e.items,"items-per-page":e.itemsPerPage,"footer-props":e.footerProps,search:e.search,"item-key":"id","show-select":"","single-select":!e.selectAll},on:{input:e.updateSelected},scopedSlots:e._u([{key:"item.name",fn:function(s){var i=s.item;return[t("router-link",{attrs:{to:{name:"pcfgDetail",params:{id:i.id}}}},[e._v(" "+e._s(i.name)+" "),t("v-icon",{attrs:{small:"",color:"primary"}},[e._v(" mdi-open-in-new ")])],1)]}},{key:"item.keyspace",fn:function(s){var i=s.item;return[e._v(" "+e._s(e.fmt(i.keyspace))+" ")]}},{key:"item.time_added",fn:function(s){var i=s.item;return[e._v(" "+e._s(e.$moment.utc(i.time_added).local().format("DD.MM.YYYY HH:mm"))+" ")]}}]),model:{value:e.selected,callback:function(s){e.selected=s},expression:"selected"}})},bt=[];const yt={name:"PcfgSelector",mixins:[y],data(){return{headers:[{text:"Name",align:"start",value:"name"},{text:"Keyspace",value:"keyspace",align:"end"},{text:"Added",value:"time_added",align:"end"}]}},watch:{value:function(){this.value&&(this.selected=this.value)}},methods:{fmt:x,getData(){this.loading=!0,this.axios.get(this.$serverAddr+"/pcfg").then(e=>{this.items=e.data.items,this.loading=!1})}}},U={};var xt=l(yt,gt,bt,!1,$t,null,null,null);function $t(e){for(let a in U)this[a]=U[a]}var wt=function(){return xt.exports}(),St=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("v-card-title",[t("span",[e._v("Select PCFG grammar"),t("span",{staticClass:"required primary--text"},[e._v(" *")])])]),t("pcfg-selector",{model:{value:e.pcfg,callback:function(s){e.pcfg=s},expression:"pcfg"}}),t("v-divider"),t("v-card-title",[t("span",[e._v("Edit keyspace limit")])]),t("v-text-field",{attrs:{outlined:"","single-line":"",required:"",type:"number",suffix:"passwords",max:e.pcfg.length>0?e.pcfg[0].keyspace:0},on:{blur:e.checkValid},model:{value:e.keyspaceLimit,callback:function(s){e.keyspaceLimit=e._n(s)},expression:"keyspaceLimit"}}),t("v-divider"),t("v-card-title",[t("span",[e._v("Select rule file")])]),t("rules-selector",{model:{value:e.rules,callback:function(s){e.rules=s},expression:"rules"}}),t("v-divider"),e.$optimizedOnly?e._e():t("v-checkbox",{attrs:{label:"Use optimized computing kernels (limits password length, disable for passwords over 256 chars long)"},model:{value:e.optimized,callback:function(s){e.optimized=s},expression:"optimized"}})],1)},Mt=[];const Ct={name:"Pcfg",components:{"pcfg-selector":wt,"rules-selector":M},data:function(){return{attackId:9,attackName:"pcfg"}},watch:{pcfg(e){e.length>0&&(this.keyspaceLimit=e[0].keyspace)}},computed:h("jobForm",p(["rules","pcfg","keyspaceLimit","optimized"])),methods:{checkValid:function(){this.pcfg.length>0&&this.keyspaceLimit>this.pcfg[0].keyspace&&(this.keyspaceLimit=this.pcfg[0].keyspace)}}},O={};var Ft=l(Ct,St,Mt,!1,Tt,"04756006",null,null);function Tt(e){for(let a in O)this[a]=O[a]}var Dt=function(){return Ft.exports}(),Ht=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("v-card-title",[t("span",[e._v("Select dictionary"),t("span",{staticClass:"required primary--text"},[e._v(" *")])])]),t("dict-selector",{attrs:{"select-all":""},on:{input:e.checkValid},model:{value:e.leftDicts,callback:function(s){e.leftDicts=s},expression:"leftDicts"}}),t("v-divider"),t("v-checkbox",{attrs:{label:"Check for password duplicates"},model:{value:e.checkDuplicates,callback:function(s){e.checkDuplicates=s},expression:"checkDuplicates"}}),t("v-divider"),t("v-checkbox",{attrs:{label:"Case permutation"},model:{value:e.casePermute,callback:function(s){e.casePermute=s},expression:"casePermute"}}),t("v-divider"),t("v-card-title",[t("span",[e._v("Minimal length of passwords (1 - 32)")])]),t("v-card-text",[t("v-text-field",{attrs:{text:"","single-line":"",value:e.minPasswordLen,required:"",type:"number",min:"1",max:"32"},on:{input:e.checkValid},model:{value:e.minPasswordLen,callback:function(s){e.minPasswordLen=e._n(s)},expression:"minPasswordLen"}})],1),t("v-divider"),t("v-card-title",[t("span",[e._v("Maximal length of passwords (1 - 32)")])]),t("v-card-text",[t("v-text-field",{attrs:{text:"","single-line":"",value:e.maxPasswordLen,required:"",type:"number",min:"1",max:"32"},on:{input:e.checkValid},model:{value:e.maxPasswordLen,callback:function(s){e.maxPasswordLen=e._n(s)},expression:"maxPasswordLen"}})],1),t("v-divider"),t("v-card-title",[t("span",[e._v("Minimal number of elements per chain (1 - 16)")])]),t("v-card-text",[t("v-text-field",{attrs:{text:"","single-line":"",value:e.minElemInChain,required:"",type:"number",min:"1",max:"16"},on:{input:e.checkValid},model:{value:e.minElemInChain,callback:function(s){e.minElemInChain=e._n(s)},expression:"minElemInChain"}})],1),t("v-divider"),t("v-card-title",[t("span",[e._v("Maximal number of elements per chain (1 - 16)")])]),t("v-card-text",[t("v-text-field",{attrs:{text:"","single-line":"",value:e.maxElemInChain,required:"",type:"number",min:"1",max:"16"},on:{input:e.checkValid},model:{value:e.maxElemInChain,callback:function(s){e.maxElemInChain=e._n(s)},expression:"maxElemInChain"}})],1),t("v-card-title",[t("span",[e._v("Edit keyspace limit")])]),t("v-text-field",{attrs:{text:"","single-line":"",value:e.keyspaceLimit,required:"",type:"number",suffix:"passwords",min:"0",max:"keyspace"},on:{input:e.checkValid},model:{value:e.keyspaceLimit,callback:function(s){e.keyspaceLimit=e._n(s)},expression:"keyspaceLimit"}}),t("v-divider"),t("v-card-title",[t("span",[e._v("Select rule file")])]),t("rules-selector",{on:{input:e.checkValid},model:{value:e.rules,callback:function(s){e.rules=s},expression:"rules"}}),t("v-card-title",[t("span",[e._v("Generate random rules")])]),t("v-text-field",{attrs:{text:"","single-line":"",value:e.generateRandomRules,required:"",type:"number",suffix:"rules",min:"0"},on:{input:e.checkValid},model:{value:e.generateRandomRules,callback:function(s){e.generateRandomRules=e._n(s)},expression:"generateRandomRules"}}),t("v-divider"),e.$optimizedOnly?e._e():t("v-checkbox",{attrs:{label:"Use optimized computing kernels (limits password length, disable for passwords over 256 chars long)"},model:{value:e.optimized,callback:function(s){e.optimized=s},expression:"optimized"}})],1)},At=[];const Lt={name:"Prince",components:{"dict-selector":b,"rules-selector":M},props:["keyspace"],watch:{keyspace(e){e&&(this.keyspaceLimit=e)}},computed:h("jobForm",p(["leftDicts","rules","checkDuplicates","casePermute","minPasswordLen","maxPasswordLen","minElemInChain","maxElemInChain","keyspaceLimit","generateRandomRules","optimized"])),methods:{checkValid:function(){return this.minPasswordLen<=0?(this.$error("Minimal length of passwords must be greater than 0."),!1):this.maxPasswordLen<=0?(this.$error("Maximal length of passwords must be greater than 0."),!1):this.maxPasswordLen>32?(this.$error("Maximal length of passwords must be smaller or equal to 32."),!1):this.minElemInChain<=0?(this.$error("Minimal number of elements per chain must be greater than 0."),!1):this.maxElemInChain<=0?(this.$error("Maximal number of elements per chain must be greater than 0."),!1):this.maxElemInChain>16?(this.$error("Maximal number of elements per chain must be to 16."),!1):this.minPasswordLen>this.maxPasswordLen?(this.$error("Minimal length of passwords must be greater than maximal length of passwords."),!1):this.minElemInChain>this.maxElemInChain?(this.$error("Minimal number of elements per chain must be smaller or equal than maximal number of elements per chain."),!1):this.maxElemInChain>this.maxPasswordLen?(this.$error("Maximal number of elements per chain must be smaller or equal than maximal length of passwords."),!1):this.keyspaceLimit<0?(this.$error("Keyspace limit must be nonnegative value."),!1):this.generateRandomRules<0?(this.$error("Random rules count must be nonnegative value."),!1):this.rules.length>0&&this.generateRandomRules>0?(this.$error("Cannot combine a rule file together with random rules generation."),!1):(this.$hideAlert(),!0)}}},W={};var jt=l(Lt,Ht,At,!1,Nt,"35954e64",null,null);function Nt(e){for(let a in W)this[a]=W[a]}var Rt=function(){return jt.exports}(),Et=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("v-dialog",{attrs:{width:"800"},scopedSlots:e._u([{key:"activator",fn:function(s){var i=s.on;return[t("v-btn",e._g({attrs:{disabled:!e.validTemplate,large:"",color:"primary"},on:{click:e.nameMe}},i),[t("v-icon",{attrs:{left:""}},[e._v(" mdi-file-plus ")]),e._v("Manage Template ")],1)]}}]),model:{value:e.dialog,callback:function(s){e.dialog=s},expression:"dialog"}},[t("v-card",[t("v-card-title",{attrs:{"primary-title":""}},[e._v(" Job template ")]),t("v-card-text",[t("div",{staticClass:"flex mb-3"},[t("v-icon",{attrs:{left:""}},[e._v(" info ")]),t("div",[e._v(" The choices you made in the job configuration will be saved as a template."),t("br"),e._v(" You can pre-fill any new job configuration with templates you saved. "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.name!==""&&e.name===e.inheritedName,expression:"name !== '' && name === inheritedName"}]},[e._v(" Keep the name to update an existing template. ")])])],1),t("v-text-field",{attrs:{id:"templateName",name:"templateName",outlined:"",dense:"","hide-details":"",label:"Template name"},model:{value:e.name,callback:function(s){e.name=s},expression:"name"}})],1),t("v-card-actions",[t("v-spacer"),t("v-btn",{attrs:{text:""},on:{click:function(s){e.dialog=!e.dialog}}},[e._v(" Back to editing ")]),t("v-btn",{attrs:{color:"primary",text:"",disabled:e.name===""},on:{click:e.submit}},[e._v(" "+e._s(e.name!==""&&e.name===e.inheritedName?"Update":"Save")+" template ")])],1)],1)],1)},Pt=[];const zt={name:"TemplateModal",props:{inheritedName:{type:String,default:""}},data(){return{dialog:!1,name:""}},computed:H("jobForm",["validTemplate"]),methods:{submit(){const e=this.$store.getters["jobForm/makeTemplate"](this.name);console.log(e),this.loading=!0,this.axios.put(this.$serverAddr+"/template",e).then(a=>{this.$emit("templatesUpdated")}).catch(a=>{this.loading=!1}),this.dialog=!1},nameMe(){this.name=this.inheritedName}}},K={};var It=l(zt,Et,Pt,!1,Vt,"6bb7b305",null,null);function Vt(e){for(let a in K)this[a]=K[a]}var Yt=function(){return It.exports}(),Bt=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"containerAddJob height100 mx-auto"},[t("v-scale-transition",[t("v-sheet",{directives:[{name:"show",rawName:"v-show",value:e.keyspaceKnown&&e.keyspace||e.estimatedTime,expression:"keyspaceKnown && keyspace || estimatedTime"}],staticClass:"infobar",attrs:{color:"info",dark:"",elevation:"8"}},[t("div",{staticClass:"d-flex"},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.keyspace,expression:"keyspace"}],staticClass:"text-end"},[t("div",{staticClass:"overline"},[t("v-icon",{staticClass:"mr-1",attrs:{"x-small":""}},[e._v(" mdi-key ")]),t("span",[e._v(" Keyspace ")])],1),t("div",[e._v(e._s(e.numberFormat(e.keyspace)))])]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.estimatedTime,expression:"estimatedTime"}],staticClass:"ml-4 text-end"},[t("div",{staticClass:"overline"},[t("v-icon",{staticClass:"mr-1",attrs:{"x-small":""}},[e._v(" mdi-timelapse ")]),t("span",[e._v(" Est. cracking time ")])],1),t("div",[e._v(e._s(e.estimatedTime))])])])])],1),t("div",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"loadingProgressCont"},[t("v-progress-circular",{staticClass:"loadingProgress",attrs:{indeterminate:"",color:"primary",size:"65",width:4}})],1),t("v-row",[t("v-col",[e.helpAlreadyDismissed?e._e():t("v-alert",{attrs:{text:"",type:"success",icon:"mdi-help-box",dismissible:""},scopedSlots:e._u([{key:"close",fn:function(s){var i=s.toggle;return[t("v-btn",{attrs:{text:"",small:""},on:{click:function(r){return e.dismissHelp(i)}}},[e._v(" Don't show anymore "),t("v-icon",{attrs:{right:""}},[e._v("mdi-close")])],1)]}}],null,!1,3779908090)},[e._v(" If you need help with creating a job, you can "),t("a",{attrs:{target:"_blank",href:e.$docsLink+"/#/jobs/creating/overview"}},[e._v("read the user manual here")]),e._v(". ")]),e.helpDismissedMessage?t("v-alert",{attrs:{text:"",type:"info",dismissible:""}},[e._v(" Sure. If you need help at any time in the future, use the link in the top right corner. ")]):e._e()],1)],1),t("v-row",[t("v-col",[t("v-text-field",{attrs:{outlined:"",autofocus:"",required:"",label:"Name",hint:"Give this job a descriptive name","persistent-hint":""},model:{value:e.name,callback:function(s){e.name=s},expression:"name"}})],1),t("v-col",[t("v-autocomplete",{attrs:{items:e.templates,"item-text":"name","item-value":"id",value:e.selectedTemplate,"auto-select-first":"",outlined:"",label:"Template",hint:"Prefill the form with a saved template (use empty to quickly reset)","persistent-hint":""},on:{input:e.fetchAndApplyTemplate}})],1)],1),t("div",[t("v-col",[t("v-stepper",{staticClass:"mb-4",attrs:{id:"job-stepper",vertical:"","non-linear":""},model:{value:e.step,callback:function(s){e.step=s},expression:"step"}},[t("v-stepper-step",{attrs:{id:"job-step-1",editable:"",step:"1"}},[e._v(" Input settings ")]),t("v-stepper-content",{attrs:{step:"1"}},[t("v-container",[t("v-row",{staticClass:"mb-4"},[t("v-btn-toggle",{staticClass:"mr-2",attrs:{mandatory:"",color:"primary"},model:{value:e.inputMethod,callback:function(s){e.inputMethod=s},expression:"inputMethod"}},[t("v-btn",{attrs:{id:"job-input-mode-manual",value:"multipleHashes"}},[e._v(" Manual entry ")]),t("v-btn",{attrs:{id:"job-input-mode-hashlist",value:"hashFile"}},[e._v(" From hash file ")]),t("v-btn",{attrs:{id:"job-input-mode-extract",value:"extractFromFile"}},[e._v(" Extract from file ")])],1),t("v-autocomplete",{attrs:{id:"hash-type-select",editable:"","validate-on-blur":"",clearable:"",label:"Select hash type",items:e.hashTypes,"item-text":"name",filter:e.hashTypeFilter,"return-object":"",required:"","hide-details":"","single-line":"",flat:"","solo-inverted":"","no-data-text":"No matching hash type"},on:{change:function(s){return e.validateHashes(null)}},scopedSlots:e._u([{key:"item",fn:function(s){var i=s.item;return[t("v-list-item-content",[t("v-list-item-title",[t("b",[e._v(e._s(i.code))]),e._v(" - "+e._s(i.name))])],1)]}}]),model:{value:e.hashType,callback:function(s){e.hashType=s},expression:"hashType"}})],1),t("v-row",[e.inputMethod==="extractFromFile"?t("v-col",{attrs:{cols:"12"}},[t("v-alert",{attrs:{type:"info",text:""}},[e._v(" Supported formats: "),t("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(s){var i=s.on;return[t("span",e._g({},i),[t("a",{staticClass:"filetype-link",attrs:{href:"#"}},[e._v("MS_OFFICE")]),e._v(",")])]}}],null,!1,4231528392)},[t("span",[e._v("Hash types: 9400, 9500, 9600, 9700, 9800")])]),t("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(s){var i=s.on;return[t("span",e._g({},i),[t("a",{staticClass:"filetype-link",attrs:{href:"#"}},[e._v("PDF")]),e._v(",")])]}}],null,!1,2332527323)},[t("span",[e._v("Hash types: 10400, 10500, 10600, 10700")])]),t("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(s){var i=s.on;return[t("span",e._g({},i),[t("a",{staticClass:"filetype-link",attrs:{href:"#"}},[e._v("7Z")]),e._v(",")])]}}],null,!1,3020928356)},[t("span",[e._v("Hash type: 11600")])]),t("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(s){var i=s.on;return[t("span",e._g({},i),[t("a",{staticClass:"filetype-link",attrs:{href:"#"}},[e._v("RAR")]),e._v(" and ")])]}}],null,!1,3417299535)},[t("span",[e._v("Hash types: 12500, 13000, 23700, 23800")])]),t("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(s){var i=s.on;return[t("span",e._g({},i),[t("a",{staticClass:"filetype-link",attrs:{href:"#"}},[e._v("ZIP")]),e._v(".")])]}}],null,!1,4251728136)},[t("span",[e._v("Hash types: 13600, 17200, 17210, 17225, 13001, 23002, 23003")])])],1),t("file-uploader",{ref:"encryptedFileUploader",attrs:{url:this.$serverAddr+"/protectedFiles/add"},on:{uploadComplete:e.uploadComplete}})],1):e._e(),e.inputMethod==="hashFile"?t("v-col",{attrs:{cols:"12"}},[t("v-alert",{attrs:{type:"info",text:""}},[e._v(" Input to hashcat. Select a binary hash (WPA/WPA2), or plain text hashlist. ")]),t("file-uploader",{ref:"hashFileUploader",attrs:{multiple:!1,"no-upload":"",label:"Select a file to read"},on:{filesChanged:e.hashFileSelected}})],1):e._e(),t("v-col",{attrs:{cols:"12"}},[t("v-alert",{staticClass:"mt-0 mb-0",attrs:{value:e.gotBinaryHash,text:"",type:"info",color:"primary"}},[e._v(" You can select only one binary hash. ")]),e.inputMethod!==null?t("fc-textarea",{ref:"textarea",staticClass:"textarea",class:{hasherror:e.hashListError},attrs:{id:"hashes-input","max-height":"500",readonly:!(e.inputMethod==="multipleHashes"&&!e.gotBinaryHash),"can-remove-line":!0},on:{blur:e.validateHashes,focus:e.unvalidateHashes},model:{value:e.hashList,callback:function(s){e.hashList=s},expression:"hashList"}},[t("div",{staticClass:"hashCeckContainer pl-1 pt-2",attrs:{slot:"after"},slot:"after"},e._l(e.validatedHashes,function(s){return t("div",{key:s.id},[s.result==="OK"?t("v-icon",{attrs:{small:"",color:"success"}},[e._v(" check_circle_outlined ")]):t("v-tooltip",{attrs:{left:""},scopedSlots:e._u([{key:"activator",fn:function(i){var r=i.on;return[t("v-icon",e._g({staticClass:"clickable",attrs:{small:"",color:"error"}},r),[e._v(" error_circle_outlined ")])]}}],null,!0)},[t("span",[e._v(e._s(s.result))])]),s.isInCache?t("v-tooltip",{attrs:{left:""},scopedSlots:e._u([{key:"activator",fn:function(i){var r=i.on;return[t("v-icon",e._g({staticClass:"clickable",attrs:{small:"",color:"warning"}},r),[e._v(" error_circle_outlined ")])]}}],null,!0)},[t("span",[e._v("hash already in hashcache")])]):e._e()],1)}),0)]):e._e()],1)],1),t("v-row",[e.dev?t("v-btn",{attrs:{text:"",color:"success"},on:{click:e.getRandomHash}},[t("v-icon",{attrs:{left:""}},[e._v(" mdi-auto-fix ")]),e._v(" Random SHA1 ")],1):e._e(),t("v-checkbox",{directives:[{name:"show",rawName:"v-show",value:e.invalidHashes.length>0,expression:"invalidHashes.length > 0"}],staticClass:"ml-2 mt-1",attrs:{label:"Ignore invalid hashes","hide-details":"",height:15,color:"error"},model:{value:e.ignoreHashes,callback:function(s){e.ignoreHashes=s},expression:"ignoreHashes"}}),t("v-spacer"),t("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.hashList!=="",expression:"hashList !== ''"}],staticClass:"mr-2",attrs:{color:"error",text:""},on:{click:e.clearInput}},[e._v(" Reset ")]),t("v-btn",{attrs:{color:"primary"},on:{click:function(s){e.step=2}}},[e._v(" Next ")])],1)],1)],1),t("v-stepper-step",{attrs:{id:"job-step-2",editable:"",step:"2"}},[e._v(" Attack settings ")]),t("v-stepper-content",{attrs:{step:"2"}},[t("v-container",[t("v-card-title",[e._v("Attack mode")]),t("v-item-group",{staticClass:"d-flex flex-wrap justify-space-between",model:{value:e.attackSettingsTab,callback:function(s){e.attackSettingsTab=s},expression:"attackSettingsTab"}},e._l(e.attacks,function(s,i){return t("v-item",{key:i,attrs:{value:s.handler},scopedSlots:e._u([{key:"default",fn:function(r){var n=r.active,d=r.toggle;return[t("v-btn",{staticClass:"mode-btn",attrs:{id:"attack-mode-"+s.handler,text:"",small:"",color:n?"primary":""},on:{click:d}},[t("div",{staticClass:"my-3"},[t("v-icon",{staticClass:"mb-2"},[e._v(" "+e._s(e.attackIcon(s.handler))+" ")]),t("div",[e._v(e._s(s.name))])],1)])]}}],null,!0)})}),1),t(e.attackSettingsTab,{tag:"v-component",attrs:{id:e.attackSettingsTab,keyspace:e.keyspace}}),t("v-row",[t("v-spacer"),t("v-btn",{staticClass:"mr-6 mt-4",attrs:{color:"primary"},on:{click:function(s){e.step=3}}},[e._v(" Next ")])],1)],1)],1),t("v-stepper-step",{attrs:{id:"job-step-3",editable:"",step:"3"}},[e._v(" Host assignment ")]),t("v-stepper-content",{attrs:{step:"3"}},[t("v-container",[t("v-subheader",[e._v("Select which hosts to distribute workunits to")]),t("div",{staticClass:"scroller"},[t("host-selector",{attrs:{"select-all":"","auto-refresh":""},model:{value:e.hosts,callback:function(s){e.hosts=s},expression:"hosts"}})],1),t("v-subheader",[t("b",[e._v("("+e._s(e.hosts.length)+" selected)")])]),t("v-row",[t("v-spacer"),t("v-btn",{staticClass:"mr-6 mt-4",attrs:{color:"primary"},on:{click:function(s){e.step=4}}},[e._v(" Next ")])],1)],1)],1),t("v-stepper-step",{attrs:{id:"job-step-4",editable:"",step:"4"}},[e._v(" Additional settings ")]),t("v-stepper-content",{attrs:{step:"4"}},[t("v-container",[t("v-row",[t("v-textarea",{attrs:{id:"comment-input",label:"Comment",outlined:"","auto-grow":"",rows:1},model:{value:e.comment,callback:function(s){e.comment=s},expression:"comment"}})],1),t("v-row",[t("v-col",[t("div",{staticClass:"title mb-2"},[e._v("Planned start")]),t("dt-picker",{attrs:{outlined:"","hide-details":"",disabled:e.startNow,"single-line":"",label:""},model:{value:e.startDate,callback:function(s){e.startDate=s},expression:"startDate"}}),t("v-checkbox",{attrs:{label:"Immediately"},model:{value:e.startNow,callback:function(s){e.startNow=s},expression:"startNow"}})],1),t("v-col",[t("div",{staticClass:"title mb-2"},[e._v(" Desired time per workunit ")]),t("v-text-field",{attrs:{outlined:"","hide-details":"","single-line":"",label:"Time for job",required:"",type:"number",suffix:"seconds",min:60},model:{value:e.timeForJob,callback:function(s){e.timeForJob=s},expression:"timeForJob"}})],1),t("v-col",[t("div",{staticClass:"title mb-2"},[e._v("Planned end")]),t("dt-picker",{attrs:{outlined:"","hide-details":"",disabled:e.endNever,"single-line":""},model:{value:e.endDate,callback:function(s){e.endDate=s},expression:"endDate"}}),t("v-checkbox",{attrs:{label:"No time limit"},model:{value:e.endNever,callback:function(s){e.endNever=s},expression:"endNever"}})],1)],1)],1)],1)],1),e.hosts.length==0?t("v-row",{attrs:{justify:"center"}},[t("v-alert",{attrs:{outlined:"",type:"warning"}},[e._v(" This job has no hosts assigned to it and won't be able to run until edited! ")])],1):e._e(),e.timeForJob<180?t("v-row",{attrs:{justify:"center"}},[t("v-alert",{attrs:{outlined:"",type:"warning"}},[e._v(" Setting extremely low time per workunit leads to high overhead. The cracking may take much longer than estimated. Consider choosing a higher value. ")])],1):e._e(),t("v-row",{staticClass:"mb-5 mt-2",attrs:{justify:"center"}},[t("template-modal",{attrs:{"inherited-name":e.selectedTemplateName},on:{templatesUpdated:e.fetchTemplates}}),t("v-btn",{staticClass:"ml-2",attrs:{large:"",color:"primary"},on:{click:e.submit}},[t("v-icon",{attrs:{left:""}},[e._v(" "+e._s(e.canCreateJob()?"mdi-check":"mdi-content-save")+" ")]),e._v(" "+e._s(e.canCreateJob()?"Create":"Save for later")+" ")],1)],1)],1)],1)],1)},qt=[];const Jt={name:"AddJob",components:{FileUploader:ue,combinator:ye,maskattack:Ke,dictionary:nt,hybridMaskWordlist:mt,hybridWordlistMask:kt,pcfgAttack:Dt,princeAttack:Rt,"fc-textarea":me,"host-selector":ve,"template-modal":Yt,dtPicker:he},data:function(){return{loading:!1,helpDismissedMessage:!1,hashTypes:[],showEstimatedTime:!1,estimatedTime:null,keyspace:null,gotBinaryHash:!1,hashListError:!1,selectedTemplateName:"",attacks:ce,templates:[{name:"Empty",id:0}]}},computed:g(v(v(v({},de("jobForm",["selectedTemplate"])),h("jobForm",p(["step","attackSettingsTab","validatedHashes","name","inputMethod","hashList","hashType","ignoreHashes","startDate","endDate","template","comment","hosts","startNow","endNever","timeForJob"]))),H("jobForm",["jobSettings","valid","validAttackSpecificSettings","keyspaceKnown"])),{templateItems(){return this.templates.map((e,a)=>({text:e.template,value:a}))},invalidHashes(){return this.validatedHashes.filter(e=>e.result!=="OK")},dev(){return localStorage.getItem("testmode")=="true"},helpAlreadyDismissed(){return localStorage.getItem("dismissedHelp")=="true"}}),watch:{jobSettings(e){if(this.estimatedTime=null,this.keyspace=null,e.attack_settings!=!1&&this.validAttackSpecificSettings){var a=[];for(let s=0;s<this.hosts.length;s++)a.push(this.hosts[s].id);var t=this.hashType==null?-1:this.hashType.code;this.axios.post(this.$serverAddr+"/job/crackingTime",{hash_type_code:t,boinc_host_ids:a.join(","),attack_settings:JSON.stringify(e.attack_settings)}).then(s=>{s.data&&(this.estimatedTime=s.data.display_time,this.keyspace=s.data.keyspace)})}}},mounted:function(){this.loadSettings(),this.getHashTypes(),this.startDate=this.$moment().format("YYYY-MM-DDTHH:mm"),this.endDate=this.$moment().format("YYYY-MM-DDTHH:mm"),this.hashList.length>0&&this.validateHashes(),this.fetchTemplates(),this.name===""&&this.generateJobName()},methods:g(v({},D("jobForm",["applyTemplate"])),{numberFormat:x,attackIcon:oe,async loadSettings(){if(!this.timeForJob){const e=await this.axios.get(this.$serverAddr+"/settings").then(a=>a.data);this.timeForJob=e.default_seconds_per_workunit}},dismissHelp(e){localStorage.setItem("dismissedHelp",!0),e(),this.helpDismissedMessage=!0},fetchTemplates(){this.axios.get(this.$serverAddr+"/template").then(e=>{e.data&&e.data.items&&(this.templates=[{name:"Empty",id:0},...e.data.items])}).catch(console.error)},fetchAndApplyTemplate(e){if(e==0){this.applyTemplate(),this.selectedTemplateName="",this.$store.commit("jobForm/selectedTemplateMut",0),this.loadSettings();return}this.axios.get(this.$serverAddr+`/template/${e}`).then(a=>{if(a.data&&a.data.template){const t=JSON.parse(a.data.template);this.applyTemplate(t),this.selectedTemplateName=t.template,this.$store.commit("jobForm/selectedTemplateMut",e)}}).catch(console.error)},hashTypeFilter({name:e,code:a},t){const s=t.toLowerCase();return e.toLowerCase().includes(s)||a.toLowerCase().includes(s)},subHashtypeChanged:function(e,a){this.hashType.code=this.hashType.code.replace(e,a.code),this.validateHashes(null)},focusTextarea:function(){this.$refs.textarea.focus()},validateHashes:function(e=null){e===null&&(e=this.hashList),e.split(`
`),e.startsWith("BASE64:")?this.gotBinaryHash=!0:this.gotBinaryHash=!1,!(this.hashType===null||isNaN(this.hashType.code))&&e!==""&&this.axios.post(this.$serverAddr+"/job/verifyHash",{hashtype:this.hashType.code,hashes:e}).then(a=>{this.hashListError=a.data.error,this.validatedHashes=a.data.items})},unvalidateHashes:function(e){this.validatedHashes=[]},getHashTypes:function(){this.axios.get(this.$serverAddr+"/hashcat/hashTypes").then(e=>{this.hashTypes=e.data.hashtypes})},addHash:function(e){var a=this.hashList.split(`
`),t=a[a.length-1];t===""?this.hashList=this.hashList+e:this.hashList=this.hashList+`
`+e},uploadComplete:function(e){this.$success("Successfully extracted hash form file."),this.hashType=this.hashTypes.find(a=>a.code==e.hash_type),this.addHash(e.hash),this.validateHashes(null)},isBinaryFile:function(e){for(var a=0;a<24;a++){var t=e.charCodeAt(a);if(t===65533||t<=8)return!0}return!1},hashFileSelected:function(e){var a=new FileReader;a.onloadend=function(t){if(t.target.readyState==FileReader.DONE)if(this.isBinaryFile(t.target.result)){var s=new FileReader;s.onloadend=function(n){n.target.readyState==FileReader.DONE&&(this.hashList="BASE64:"+n.target.result.substr(n.target.result.indexOf(",")+1),this.validateHashes(null),this.gotBinaryHash=!0)}.bind(this),s.readAsDataURL(e)}else{var i=this.hashList.split(`
`),r=i[i.length-1];r===""?this.hashList+=t.target.result:this.hashList+=`
`+t.target.result,this.validateHashes(null)}}.bind(this),a.readAsText(e,"utf-8")},clearInput(){this.hashType=null,this.hashList="",this.unvalidateHashes()},submit(){if(this.name===""){this.$error("Job name can not be empty.");return}if(this.inputMethod==="encryptedFile"&&!this.$refs.encryptedFileUploader.fileUploaded){this.$error("No file uploaded."),this.step=1;return}if(this.hashType===null){this.$error("No hash type selected."),this.step=1;return}if(this.invalidHashes.length>0&&!this.ignoreHashes){this.$error("Some hashes are invalid."),this.step=1;return}if(this.validatedHashes.length==0){this.$error("List of validated hashes is empty."),this.step=1;return}if(!this.attackSettingsTab){this.$error("No attack selected."),this.step=2;return}if(this.jobSettings.attack_settings===!1){this.$error("Error in attack settings."),this.step=2;return}if(this.keyspace>18446744e12){this.$error("Job keyspace is higher than maximal allowed value 2^64."),this.step=2;return}if(this.timeForJob<10){this.$error("Time per workunit must be higher or equal to 10 seconds."),this.step=4;return}if(!this.valid){this.$error("Error in attack settings."),this.step=2;return}this.loading=!0,console.log(this.jobSettings.endNever);const e=this.startNow?this.jobSettings.time_start:this.$moment(this.jobSettings.time_start).utc().toISOString(!0).slice(0,16),a=this.endNever?this.jobSettings.time_end:this.$moment(this.jobSettings.time_end).utc().toISOString(!0).slice(0,16),t=g(v({},this.jobSettings),{time_start:e,time_end:a});this.axios.post(this.$serverAddr+"/job",t).then(s=>{this.$router.push({name:"jobDetail",params:{id:s.data.job_id}}),this.applyTemplate()}).catch(s=>{this.loading=!1})},getRandomHash(){const e=Math.random().toString(36).substring(2,6);this.hashList+=`${pe(e)}
`,this.hashType={code:"100",name:"SHA1"},this.comment+=`(${e}) `,this.validateHashes()},generateJobName(){this.name=this.$store.state.project+" Job \u2013 "+this.$moment().format("DD.MM.YYYY HH:mm")},canCreateJob(){return this.hosts.some(e=>e.last_active.online)}})},Z={};var Ut=l(Jt,Bt,qt,!1,Ot,"2d997273",null,null);function Ot(e){for(let a in Z)this[a]=Z[a]}var cs=function(){return Ut.exports}();export{cs as default};
